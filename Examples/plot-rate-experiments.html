<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Plotting rate experiments &mdash; GES-echem-suite Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sphinx-thebe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script src="../_static/design-tabs.js"></script>
        <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
        <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plotting cyclic voltammetry experiments" href="plot-cyclicvoltammetry.html" />
    <link rel="prev" title="Plotting cycles" href="plot-cycles.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../intro.html" class="icon icon-home">
            Python
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide.html">User guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot-cycles.html">Plotting cycles</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plotting rate experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot-cyclicvoltammetry.html">Plotting cyclic voltammetry experiments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor-guide.html">Contributor’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../intro.html">Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../intro.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Plotting rate experiments</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Examples/plot-rate-experiments.md" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="plotting-rate-experiments">
<span id="examples-plot-rate-experiments"></span><h1>Plotting rate experiments<a class="headerlink" href="#plotting-rate-experiments" title="Permalink to this heading"></a></h1>
<p>A rate experiment can be constructed directly from a Biologic battery module file or can be generated manually by a set of user specified cell-cycling experiments. In this page we will present scripts that cover different types of situations encountered during routine data-analysis tasks:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#examples-plot-rate-experiments-battmodule"><span class="std std-ref">Plot a single set of data from a Biologic Battery module file</span></a></p></li>
<li><p><a class="reference internal" href="#examples-plot-rate-experiments-arbin"><span class="std std-ref">Plot a single set of data from an ARBIN <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file</span></a></p></li>
<li><p><a class="reference internal" href="#examples-plot-rate-experiments-user-defined"><span class="std std-ref">Plot a single set of data from a user defined experiment</span></a></p></li>
<li><p><a class="reference internal" href="#examples-plot-rate-experiments-comparison"><span class="std std-ref">Plot more than one experiment in the same figure</span></a></p></li>
</ul>
<section id="plot-a-single-set-of-data-from-a-biologic-battery-module-file">
<span id="examples-plot-rate-experiments-battmodule"></span><h2>Plot a single set of data from a Biologic Battery module file<a class="headerlink" href="#plot-a-single-set-of-data-from-a-biologic-battery-module-file" title="Permalink to this heading"></a></h2>
<p>The following script can be used to diectly parse a Biologic battery module file (in <code class="docutils literal notranslate"><span class="pre">.mpt</span></code> format) to generate an instance of the <code class="docutils literal notranslate"><span class="pre">RateExperiment</span></code> class. Volumetric capacity and coulombic efficiencies are then plotted on a double y-axis graph. In this case the color of the markers has been set manually to <code class="docutils literal notranslate"><span class="pre">#FF00BB</span></code> and a transparency of 20% (<code class="docutils literal notranslate"><span class="pre">alpha=0.8</span></code>) has been set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">echemsuite.cellcycling.experiments</span> <span class="kn">import</span> <span class="n">RateExperiment</span>

<span class="c1"># Read the rate experiment data from the Biologic battery module file and set the electorlyte volume</span>
<span class="n">volume</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">RateExperiment</span><span class="o">.</span><span class="n">from_Biologic_battery_module</span><span class="p">(</span><span class="s2">&quot;../utils/biologic_battery_module.mpt&quot;</span><span class="p">)</span>

<span class="c1"># Set the color to be used in the plot</span>
<span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#FF00BB&quot;</span>

<span class="c1"># Extract the data that needs to be plotted</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">numbers</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">capacity</span>
<span class="n">CE</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">coulomb_efficiencies</span>

<span class="c1"># Compute on the fly the volumetric capacity in Ah/L starting from the capacity list (in mAh)</span>
<span class="n">VC</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">volume</span><span class="p">)</span> <span class="k">if</span> <span class="n">q</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>

<span class="c1"># Setup the figure and define a second y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span> 
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

<span class="c1"># Plot the volumetric capacity on the main axis</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">VC</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;◼  Volumetric capacity (Ah/L)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">44</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#DDDDDD&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#EEEEEE&quot;</span><span class="p">)</span>

<span class="c1"># Plot the coulombic efficiency on the secondary axis</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">CE</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;●  Coulumbic efficiency (%)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">110</span><span class="p">))</span>

<span class="c1"># Set the x-label of the plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Cycle number&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/658a0b75196d44bc8004941b6aa86ada7eb234e98f781791ef549edcb13b0197.png" src="../_images/658a0b75196d44bc8004941b6aa86ada7eb234e98f781791ef549edcb13b0197.png" />
</div>
</div>
</section>
<section id="plot-a-single-set-of-data-from-an-arbin-csv-file">
<span id="examples-plot-rate-experiments-arbin"></span><h2>Plot a single set of data from an ARBIN <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file<a class="headerlink" href="#plot-a-single-set-of-data-from-an-arbin-csv-file" title="Permalink to this heading"></a></h2>
<p>The following script can be used to diectly parse an ARBIN <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file to generate an instance of the <code class="docutils literal notranslate"><span class="pre">RateExperiment</span></code> class. Volumetric capacity and coulombic efficiencies are then plotted on a double y-axis graph. In this case the color of the markers has been set manually to <code class="docutils literal notranslate"><span class="pre">#03FC3D</span></code> and a transparency of 20% (<code class="docutils literal notranslate"><span class="pre">alpha=0.8</span></code>) has been set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">echemsuite.cellcycling.experiments</span> <span class="kn">import</span> <span class="n">RateExperiment</span>

<span class="c1"># Read the rate experiment data from the Biologic battery module file and set the electorlyte volume</span>
<span class="n">volume</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">RateExperiment</span><span class="o">.</span><span class="n">from_ARBIN_csv_file</span><span class="p">(</span><span class="s2">&quot;../utils/arbin_sample.CSV&quot;</span><span class="p">)</span>

<span class="c1"># Set the color to be used in the plot</span>
<span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#03FC3D&quot;</span>

<span class="c1"># Extract the data that needs to be plotted</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">numbers</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">capacity</span>
<span class="n">CE</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">coulomb_efficiencies</span>

<span class="c1"># Compute on the fly the volumetric capacity in Ah/L starting from the capacity list (in mAh)</span>
<span class="n">VC</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">volume</span><span class="p">)</span> <span class="k">if</span> <span class="n">q</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>

<span class="c1"># Setup the figure and define a second y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span> 
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

<span class="c1"># Plot the volumetric capacity on the main axis</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">VC</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;◼  Volumetric capacity (Ah/L)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">44</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#DDDDDD&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#EEEEEE&quot;</span><span class="p">)</span>

<span class="c1"># Plot the coulombic efficiency on the secondary axis</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">CE</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;●  Coulumbic efficiency (%)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">110</span><span class="p">))</span>

<span class="c1"># Set the x-label of the plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Cycle number&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a1e656ffb7ba48764cf0556e68f217b2863a326dbdbcd2be6dcf74d1fe08566b.png" src="../_images/a1e656ffb7ba48764cf0556e68f217b2863a326dbdbcd2be6dcf74d1fe08566b.png" />
</div>
</div>
</section>
<section id="plot-a-single-set-of-data-from-a-user-defined-experiment">
<span id="examples-plot-rate-experiments-user-defined"></span><h2>Plot a single set of data from a user defined experiment<a class="headerlink" href="#plot-a-single-set-of-data-from-a-user-defined-experiment" title="Permalink to this heading"></a></h2>
<p>The following script can be used to generate a <code class="docutils literal notranslate"><span class="pre">RateExperiment</span></code> object starting from a set of discrate current steps recorded in separated files. In this case the two current steps are in the format of multiple <code class="docutils literal notranslate"><span class="pre">.DTA</span></code> files located in different folders. Once loaded in <code class="docutils literal notranslate"><span class="pre">CellCycling</span></code> format, the data are merged into the final <code class="docutils literal notranslate"><span class="pre">RateExperiment</span></code> object. Volumetric capacity and coulombic efficiencies are then plotted on a double y-axis graph. In this case the color of the markers has been set manually to <code class="docutils literal notranslate"><span class="pre">#00FFDD</span></code> and a transparency of 20% (<code class="docutils literal notranslate"><span class="pre">alpha=0.8</span></code>) has been set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">echemsuite.cellcycling.cycles</span> <span class="kn">import</span> <span class="n">CellCycling</span>
<span class="kn">from</span> <span class="nn">echemsuite.cellcycling.read_input</span> <span class="kn">import</span> <span class="n">FileManager</span>
<span class="kn">from</span> <span class="nn">echemsuite.cellcycling.experiments</span> <span class="kn">import</span> <span class="n">RateExperiment</span>

<span class="c1"># Simple helper function defined to load a cellcycling experiment in a single line</span>
<span class="k">def</span> <span class="nf">quickload_folder</span><span class="p">(</span><span class="n">folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">extension</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CellCycling</span><span class="p">:</span>
    <span class="n">manager</span> <span class="o">=</span> <span class="n">FileManager</span><span class="p">()</span>
    <span class="n">manager</span><span class="o">.</span><span class="n">fetch_from_folder</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">extension</span><span class="p">)</span>
    <span class="n">cellcycling</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_cellcycling</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">cellcycling</span>

<span class="c1"># Manually read the cell-cycling steps recorded, at different currents, in the .DTA files</span>
<span class="n">step_1</span> <span class="o">=</span> <span class="n">quickload_folder</span><span class="p">(</span><span class="s2">&quot;../utils/gamry_cellcycling/step_0,1A&quot;</span><span class="p">,</span> <span class="s2">&quot;.DTA&quot;</span><span class="p">)</span>
<span class="n">step_2</span> <span class="o">=</span> <span class="n">quickload_folder</span><span class="p">(</span><span class="s2">&quot;../utils/gamry_cellcycling/step_0,3A&quot;</span><span class="p">,</span> <span class="s2">&quot;.DTA&quot;</span><span class="p">)</span>

<span class="c1"># Define an experiment from the data just obtained and set the electrolyte volume</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">RateExperiment</span><span class="p">(</span><span class="n">current_steps</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="n">cellcycling_steps</span><span class="o">=</span><span class="p">[</span><span class="n">step_1</span><span class="p">,</span> <span class="n">step_2</span><span class="p">])</span>
<span class="n">volume</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1"># Set the color to be used in the plot</span>
<span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#00FFDD&quot;</span>

<span class="c1"># Extract the data that needs to be plotted</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">numbers</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">capacity</span>
<span class="n">CE</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">coulomb_efficiencies</span>

<span class="c1"># Compute on the fly the volumetric capacity in Ah/L starting from the capacity list (in mAh)</span>
<span class="n">VC</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">volume</span><span class="p">)</span> <span class="k">if</span> <span class="n">q</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>

<span class="c1"># Setup the figure and define a second y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span> 
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

<span class="c1"># Plot the volumetric capacity on the main axis</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">VC</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;◼  Volumetric capacity (Ah/L)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#DDDDDD&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#EEEEEE&quot;</span><span class="p">)</span>

<span class="c1"># Plot the coulombic efficiency on the secondary axis</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">CE</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;●  Coulumbic efficiency (%)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">110</span><span class="p">))</span>

<span class="c1"># Set the x-label of the plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Cycle number&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fa453eb3ccec55e01b9cd03edd203d6bca516cd120a190801497d668e0287f23.png" src="../_images/fa453eb3ccec55e01b9cd03edd203d6bca516cd120a190801497d668e0287f23.png" />
</div>
</div>
</section>
<section id="plot-more-than-one-experiment-in-the-same-figure">
<span id="examples-plot-rate-experiments-comparison"></span><h2>Plot more than one experiment in the same figure<a class="headerlink" href="#plot-more-than-one-experiment-in-the-same-figure" title="Permalink to this heading"></a></h2>
<p>More than one experiment can be plotted on the same figure to compare performances of different cell setups. The following script demonstrates how this can be done. We decided to show the most complex case possible: rate experiments with different origin file formats. The scripts also demonstrate the use of the <code class="docutils literal notranslate"><span class="pre">Palette</span></code> class to automatically generate a specified color sequence.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">echemsuite.cellcycling.cycles</span> <span class="kn">import</span> <span class="n">CellCycling</span>
<span class="kn">from</span> <span class="nn">echemsuite.cellcycling.read_input</span> <span class="kn">import</span> <span class="n">FileManager</span>
<span class="kn">from</span> <span class="nn">echemsuite.cellcycling.experiments</span> <span class="kn">import</span> <span class="n">RateExperiment</span>
<span class="kn">from</span> <span class="nn">echemsuite.graphicaltools</span> <span class="kn">import</span> <span class="n">Palette</span>

<span class="c1"># Simple helper function defined to load a cellcycling experiment in a single line</span>
<span class="k">def</span> <span class="nf">quickload_folder</span><span class="p">(</span><span class="n">folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">extension</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CellCycling</span><span class="p">:</span>
    <span class="n">manager</span> <span class="o">=</span> <span class="n">FileManager</span><span class="p">()</span>
    <span class="n">manager</span><span class="o">.</span><span class="n">fetch_from_folder</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">extension</span><span class="p">)</span>
    <span class="n">cellcycling</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_cellcycling</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">cellcycling</span>

<span class="c1"># Manually read the cell-cycling steps recorded, at different currents, in the .DTA files</span>
<span class="n">step_1</span> <span class="o">=</span> <span class="n">quickload_folder</span><span class="p">(</span><span class="s2">&quot;../utils/gamry_cellcycling/step_0,1A&quot;</span><span class="p">,</span> <span class="s2">&quot;.DTA&quot;</span><span class="p">)</span>
<span class="n">step_2</span> <span class="o">=</span> <span class="n">quickload_folder</span><span class="p">(</span><span class="s2">&quot;../utils/gamry_cellcycling/step_0,3A&quot;</span><span class="p">,</span> <span class="s2">&quot;.DTA&quot;</span><span class="p">)</span>

<span class="c1"># Define an experiment from the data just obtained and define a second one using the Biologic battery module file</span>
<span class="n">experiment_1</span> <span class="o">=</span> <span class="n">RateExperiment</span><span class="p">(</span><span class="n">current_steps</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="n">cellcycling_steps</span><span class="o">=</span><span class="p">[</span><span class="n">step_1</span><span class="p">,</span> <span class="n">step_2</span><span class="p">])</span>
<span class="n">experiment_2</span> <span class="o">=</span> <span class="n">RateExperiment</span><span class="o">.</span><span class="n">from_Biologic_battery_module</span><span class="p">(</span><span class="s2">&quot;../utils/biologic_battery_module.mpt&quot;</span><span class="p">)</span>

<span class="c1"># Group the experiments in a dictionary and define a volume list for the electrolytes</span>
<span class="n">experiments</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">experiments</span><span class="p">[</span><span class="s2">&quot;Experiment 1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">experiment_1</span>
<span class="n">experiments</span><span class="p">[</span><span class="s2">&quot;Experiment 2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">experiment_2</span>
<span class="n">volumes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>

<span class="c1"># Define a color palette to be used in the plot</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">Palette</span><span class="p">(</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">)</span>

<span class="c1"># Setup the figure and define a second y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span> 
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">experiment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">experiments</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>

    <span class="c1"># Obtain the current color from the palette</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">HEX</span>

    <span class="c1"># Extract the data that needs to be plotted</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">numbers</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">capacity</span>
    <span class="n">CE</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">coulomb_efficiencies</span>

    <span class="c1"># Compute on the fly the volumetric capacity in Ah/L starting from the capacity list (in mAh)</span>
    <span class="n">VC</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">volumes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>

    <span class="c1"># Plot the volumetric capacity on the main axis and the coulombic efficiency on the secondary axis</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">VC</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">CE</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Set axes labels</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Cycle number&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;◼  Volumetric capacity (Ah/L)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;●  Coulumbic efficiency (%)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Set the grid usin the primary axis</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#DDDDDD&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#EEEEEE&quot;</span><span class="p">)</span>

<span class="c1"># Set the plot range</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">55</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">110</span><span class="p">))</span>

<span class="c1"># Show the legend</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f9547353188d2ad53f424d62fdbb93fb9fdf11c1a60b48a461df28c2790bdc8e.png" src="../_images/f9547353188d2ad53f424d62fdbb93fb9fdf11c1a60b48a461df28c2790bdc8e.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot-cycles.html" class="btn btn-neutral float-left" title="Plotting cycles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plot-cyclicvoltammetry.html" class="btn btn-neutral float-right" title="Plotting cyclic voltammetry experiments" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>